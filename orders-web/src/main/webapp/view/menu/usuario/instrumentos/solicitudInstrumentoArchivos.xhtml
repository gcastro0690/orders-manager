<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core">

<ui:composition>
    <h:form id="solicitudInstrumentoArchivos">
        <div class="ui-g-12 ui-md-12 ui-lg-12" style="width: 70%;">
            <p:dataTable var="solArchivo" id="archivos" name="archivos" reflow="true" rows="10"
                         rowsPerPageTemplate="5,10,15,25,50" rowIndexVar="rowIndex"
                         rowKey="#{solArchivo.id}"
                         value="#{solicitudInstrumentoArchivos.archivosSolicitud}"
                         sortBy="#{solArchivo.fecha}" sortOrder="DESCENDING"
                         emptyMessage="" class="tabla" paginator="true"
                         currentPageReportTemplate="{currentPage} #{msg.de} {totalPages}"
                         paginatorPosition="bottom" selectionMode="single"
                         selection="#{solicitudInstrumentoArchivos.archivoSeleccionado}"
                         paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}">

                <p:ajax event="rowSelect" listener="#{solicitudInstrumentoArchivos.onRowSelect}"
                        update=":tabs:solicitudInstrumentoArchivos:btnActualizarArchivo :tabs:solicitudInstrumentoArchivos:archivos :tabs:formActualizar:descArchivoActualizar"/>

                <p:column headerText="#{msg.solicitud_tabla_cab_fecha}">
                    <h:outputText value="#{solArchivo.fecha.time}">
                        <f:convertDateTime pattern="dd/MM/yyyy HH:mm"/>
                    </h:outputText>
                </p:column>

                <p:column headerText="#{msg.solicitud_tabla_cab_nombre}">
                    <h:outputText value="#{solArchivo.nombre}"/>
                </p:column>
                <p:column headerText="#{msg.solicitud_tabla_cab_desc}">
                    <h:outputText value="#{solArchivo.descripcion}"/>
                </p:column>

                <p:column headerText="#{msg.solicitud_tabla_cab_ver}">
                    <ui:include src="/view/template/downloadTemplate.xhtml">
                        <ui:param name="form" value="#{false}"/>
                        <ui:param name="styleClass" value="downloadButtonTable"/>
                        <ui:param name="file" value="#{solArchivo}"/>
                    </ui:include>
                </p:column>

            </p:dataTable>
        </div>
        <div class="ui-g-12 ui-md-12 ui-lg-12" style="width: 70%;">
            <p:commandButton id="btnSubirArchivo" styleClass="boton-redondeado-verde"
                             value="#{msg.btn_subir}"
                             rendered="#{solicitudInstrumentoArchivos.botonesHabilitado}"
                             style="font-size: 12pt;"
                             onclick="PF('dlgSubir').show();"/>

            <p:commandButton id="btnActualizarArchivo" styleClass="boton-redondeado-verde"
                             value="#{msg.convenio_actualizar_archivo}"
                             rendered="#{solicitudInstrumentoArchivos.botonesHabilitado}"
                             disabled="#{solicitudInstrumentoArchivos.archivoSeleccionado == null}"
                             onclick="PF('dlgActualizar').show();"
                             style="font-size: 12pt;"/>
        </div>
    </h:form>

    <p:dialog header="#{msg.solicitud_dialog_actualizar_archivo}" widgetVar="dlgActualizar"
              modal="true" resizable="false"
              closable="false" closeOnEscape="true" width="400px" draggable="false">
        <h:form id="formActualizar">
            <h:panelGrid columns="2" cellpadding="5">
                <div class="ui-g-12 ui-md-6 ui-lg-6 etiquetaform">#{msg.solicitud_tabla_cab_desc}</div>
                <p:inputText id="descArchivoActualizar"
                             placeholder="#{msg.solicitud_tabla_cab_desc}"
                             value="#{solicitudInstrumentoArchivos.archivoNuevo.descripcion}"
                             autocomplete="off" maxlength="255"/>

                <p:fileUpload
                        fileUploadListener="#{solicitudInstrumentoArchivos.handleFileActualizar}"
                        mode="advanced"
                        dragDropSupport="false" multiple="false" auto="true"
                        label="#{msg.btn_subir}"/>

                <f:facet name="footer">
                    <p:commandButton value="#{msg.btn_aceptar_mayus}"
                                     styleClass="boton-redondeado-verde" style="font-size: 12pt;"
                                     oncomplete="PF('dlgActualizar').hide();"
                                     actionListener="#{solicitudInstrumentoArchivos.saveFileUploadActualizar}"
                                     validateClient="true"
                                     update="descArchivoActualizar :tabs:solicitudInstrumentoArchivos:btnActualizarArchivo :tabs:solicitudInstrumentoArchivos:archivos"/>

                    <p:commandButton value="#{msg.btn_cancelar}" styleClass="boton-redondeado-verde"
                                     style="font-size: 12pt;"
                                     oncomplete="PF('dlgActualizar').hide();"
                                     actionListener="#{solicitudInstrumentoArchivos.cancelFileUpload}"/>
                </f:facet>
            </h:panelGrid>
        </h:form>
    </p:dialog>


    <p:dialog header="#{msg.solicitud_dialog_subir_archivo}" widgetVar="dlgSubir" modal="true"
              resizable="false"
              closable="false" closeOnEscape="true" width="400px" draggable="false">
        <h:form id="formSubir">
            <h:panelGrid columns="2" cellpadding="5">
                <div class="ui-g-12 ui-md-6 ui-lg-6 etiquetaform">#{msg.solicitud_tabla_cab_desc}</div>
                <p:inputText id="descArchivoSubir" placeholder="#{msg.solicitud_tabla_cab_desc}"
                             value="#{solicitudInstrumentoArchivos.archivoNuevo.descripcion}"
                             autocomplete="off" maxlength="255"/>

                <p:fileUpload fileUploadListener="#{solicitudInstrumentoArchivos.handleFileUpload}"
                              mode="advanced"
                              dragDropSupport="false" multiple="false" auto="true"
                              label="#{msg.btn_subir}"/>

                <f:facet name="footer">
                    <p:commandButton value="#{msg.btn_aceptar_mayus}"
                                     styleClass="boton-redondeado-verde" style="font-size: 12pt;"
                                     oncomplete="PF('dlgSubir').hide();"
                                     actionListener="#{solicitudInstrumentoArchivos.saveFileUpload}"
                                     update="descArchivoSubir"/>

                    <p:commandButton value="#{msg.btn_cancelar}" styleClass="boton-redondeado-verde"
                                     style="font-size: 12pt;"
                                     oncomplete="PF('dlgSubir').hide();"
                                     actionListener="#{solicitudInstrumentoArchivos.cancelFileUpload}"
                                     update="descArchivoSubir"/>
                </f:facet>
            </h:panelGrid>
        </h:form>
    </p:dialog>

</ui:composition>

</html>